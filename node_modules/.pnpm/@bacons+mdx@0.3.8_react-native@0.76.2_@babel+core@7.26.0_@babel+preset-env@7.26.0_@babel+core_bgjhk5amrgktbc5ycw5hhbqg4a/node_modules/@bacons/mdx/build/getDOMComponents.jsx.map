{"version":3,"file":"getDOMComponents.jsx","sourceRoot":"","sources":["../src/getDOMComponents.tsx"],"names":[],"mappings":"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","sourcesContent":["import registry from \"@react-native/assets-registry/registry\";\nimport React, { Children } from \"react\";\nimport { PixelRatio } from \"react-native\";\n\nexport const OrderContext = React.createContext<{\n  index: number;\n  firstChild: boolean;\n  lastChild: boolean;\n  firstOfType: boolean;\n  prevSibling: string;\n} | null>(null);\n\nfunction MDImage({ src, ...props }) {\n  const resolvedSrc = React.useMemo(() => resolveAssetUri(src), [src]);\n\n  return <img {...props} src={resolvedSrc ?? undefined} />;\n}\n\nconst svgDataUriPattern = /^(data:image\\/svg\\+xml;utf8,)(.*)/;\n\nfunction resolveAssetUri(source) {\n  let uri: string | null = null;\n  if (typeof source === \"number\") {\n    // get the URI from the packager\n    let asset = registry.getAssetByID(source);\n    if (asset == null) {\n      throw new Error(\n        'Image: asset with ID \"' +\n          source +\n          '\" could not be found. Please check the image source or packager.'\n      );\n    }\n    let scale = asset.scales[0];\n    if (asset.scales.length > 1) {\n      const preferredScale = PixelRatio.get();\n      // Get the scale which is closest to the preferred scale\n      scale = asset.scales.reduce((prev, curr) =>\n        Math.abs(curr - preferredScale) < Math.abs(prev - preferredScale)\n          ? curr\n          : prev\n      );\n    }\n    const scaleSuffix = scale !== 1 ? \"@\" + scale + \"x\" : \"\";\n    uri = asset\n      ? asset.httpServerLocation +\n        \"/\" +\n        asset.name +\n        scaleSuffix +\n        \".\" +\n        asset.type\n      : \"\";\n  } else if (typeof source === \"string\") {\n    uri = source;\n  } else if (source && typeof source.uri === \"string\") {\n    uri = source.uri;\n  }\n  if (uri) {\n    const match = uri.match(svgDataUriPattern);\n    // inline SVG markup may contain characters (e.g., #, \") that need to be escaped\n    if (match) {\n      const prefix = match[1];\n      const svg = match[2];\n      const encodedSvg = encodeURIComponent(svg);\n      return \"\" + prefix + encodedSvg;\n    }\n  }\n  return uri;\n}\n\nconst HTML_KEYS = [\n  \"h1\",\n  \"h2\",\n  \"h3\",\n  \"h4\",\n  \"h5\",\n  \"h6\",\n  \"a\",\n  \"nav\",\n  \"footer\",\n  \"aside\",\n  \"header\",\n  \"main\",\n  \"article\",\n  \"section\",\n  \"p\",\n  \"b\",\n  \"s\",\n  \"i\",\n  \"q\",\n  \"blockquote\",\n  \"br\",\n  \"mark\",\n  \"code\",\n\n  \"pre\",\n  \"time\",\n  \"strong\",\n  \"del\",\n  \"em\",\n  \"hr\",\n  \"div\",\n  \"span\",\n  \"img\",\n\n  \"table\",\n  \"thead\",\n  \"tbody\",\n  \"tfoot\",\n  \"th\",\n  \"tr\",\n  \"td\",\n  \"caption\",\n\n  // Task lists\n  \"sup\",\n  \"ul\",\n  \"li\",\n  \"ol\",\n  \"input\",\n] as const;\n\nexport type ComponentKeys =\n  | \"Wrapper\"\n  | \"inlineCode\"\n  | (typeof HTML_KEYS)[number];\n\n/**\n * Get base elements that work natively to the browser. If the native app has any of these views built-in, then they can be used there too.\n */\nexport function getDOMComponents(): Record<\n  ComponentKeys,\n  React.ComponentType<any>\n> {\n  const passthroughElements = HTML_KEYS.map((elementName) => [\n    elementName,\n    stripExtras(elementName),\n  ]);\n\n  return {\n    // Defaults to ensure web always works since this is a web-first feature.\n    // Native can be extended as needed.\n    ...Object.fromEntries(passthroughElements),\n\n    Wrapper: RootWrapper,\n    inlineCode: stripExtras(\"code\"),\n    img: stripExtras(MDImage, \"img\"),\n  };\n}\n\nexport function RootWrapper({ children }) {\n  const prevChildTypes = [\"root\"];\n  const childrenCount = Children.count(children);\n  return Children.map(children, (child, index) => {\n    if (typeof child === \"string\") {\n      return child;\n    }\n    const prevSibling = prevChildTypes[prevChildTypes.length - 1];\n    const mdxType = child.props.mdxType || \"element\";\n    const isFirstOfType = prevChildTypes[prevChildTypes.length - 1] !== mdxType;\n    prevChildTypes.push(mdxType);\n\n    return (\n      <OrderContext.Provider\n        value={{\n          index,\n          firstChild: index === 0,\n          lastChild: index === childrenCount - 1,\n          firstOfType: isFirstOfType,\n          prevSibling,\n        }}\n      >\n        {child}\n      </OrderContext.Provider>\n    );\n  });\n}\n\nexport function useOrder() {\n  return React.useContext(OrderContext);\n}\n\nexport function stripExtras(Element, displayName?: string) {\n  function E({\n    firstChild,\n    lastChild,\n    firstOfType,\n    index,\n    prevSibling,\n    parentName,\n    ...props\n  }) {\n    return <Element {...props} />;\n  }\n\n  if (displayName != null) {\n    E.displayName = displayName;\n  } else if (typeof Element === \"string\") {\n    E.displayName = Element;\n  } else if (\"displayName\" in Element) {\n    E.displayName = Element.displayName;\n  }\n  return E;\n}\n"]}